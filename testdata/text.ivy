# Copyright 2021 The Go Authors. All rights reserved.
# Use of this source code is governed by a BSD-style
# license that can be found in the LICENSE file.

# The binary text operator. Verify that conversions are made when necessary,
# along with basic sanity checks. For each format verb, we check that all types
# are handled.

# Float formats
'f' text sqrt 2
	1.414214

'F' text sqrt 2
	1.414214

'g' text sqrt 2
	1.4142135623730950488016887242096980785696718753769480731766797379907324784621

'G' text sqrt 2
	1.4142135623730950488016887242096980785696718753769480731766797379907324784621

'e' text sqrt 2
	1.414214e+00

'E' text sqrt 2
	1.414214E+00

# No 'X' for floats.
'x' text sqrt 2
	0x1.6a09e6p+00

# Floating-point formats on complex values. Check that it works for vectors too, while we're here;
# that's fmtText vs. formatOne in value/format.go.
'%e' text 3j2 3j2
	3.000000e+00j2.000000e+00 3.000000e+00j2.000000e+00

'%.2f' text 3j2 3j2
	3.00j2.00 3.00j2.00

'%.g' text 3j2 3j2
	3j2 3j2

# Formats that require conversion to integer.

# Int Char BigInt Rational Float Complex
'b' text 1 'a' 9876543210 1/3 (sqrt 10) 3j2
	1 1100001 1001001100101100000001011011101010 1/11 11 11j10

# Avoid unprintable chars or ridiculous values here.
'c' text 0x31 'a' 10001/100 (sqrt 10000)
	1 a d d

'd' text 1 'a' 9876543210 1/3 (sqrt 10) 65j66
	1 97 9876543210 1/3 3 65j66

'o' text 1 'a' 9876543210 1/3 (sqrt 10) 65j66
	1 141 111454013352 1/3 3 101j102

'O' text 1 'a' 9876543210 1/3 (sqrt 10) 65j66
	0o1 0o141 0o111454013352 0o1/0o3 0o3 0o101j0o102

'U' text 1 'a' 123 1/3 (sqrt 10)
	U+0001 U+0061 U+007B U+0000 U+0003

'v' text 1 'a' 9876543210 1/3 (sqrt 10)  65j1/66 # Default output.
	1 a 9876543210 1/3 3.16227766017 65j1/66

'x' text 1 'a' 9876543210 1/3 # Float has its own hex format, above.
	1 61 24cb016ea 1/3

'X' text 1 'a' 9876543210 1/3
	1 61 24CB016EA 1/3

# More tricky cases for complex numbers: big ints, rationals, etc.
'x' text 1e9j1e9 11/16j3/16 ((sqrt 2) j (sqrt 3))
	3b9aca00j3b9aca00 b/10j3/10 0x1.6a09e6p+00j0x1.bb67afp+00

'X' text 1e9j1e9 11/16j3/16
	3B9ACA00j3B9ACA00 B/10j3/10

# Chars and strings.

# Avoid unprintable chars or ridiculous values here.

's' text 'a'
	a

's' text 'abc'
	abc

's' text 10001/100
	d

's' text sqrt 10000
	d

'q' text 'a'
	"a"

'q' text 'abc'
	"abc"

'q' text 10001/100
	"d"

'q' text sqrt 10000
	"d"

# Matrix.

'q' text 3 4 rho 'asdfsdfefasdf'
	"a" "s" "d" "f"
	"s" "d" "f" "e"
	"f" "a" "s" "d"


'q' text 3 4 rho 'asdfsdfefasdf'
	"a" "s" "d" "f"
	"s" "d" "f" "e"
	"f" "a" "s" "d"

'x' text 3 4 rho iota 12
	1 2 3 4
	5 6 7 8
	9 a b c

# Creative formatting.

'(%d)' text iota 10
	(1) (2) (3) (4) (5) (6) (7) (8) (9) (10)

'(%v)' text /iota 10
	(1) (1/2) (1/3) (1/4) (1/5) (1/6) (1/7) (1/8) (1/9) (1/10)

'(%d)' text /iota 10 # Odd but semi-intentional. Maybe change one day.
	(1) (1)/(2) (1)/(3) (1)/(4) (1)/(5) (1)/(6) (1)/(7) (1)/(8) (1)/(9) (1)/(10)

'%.2f' text '1234'
	49.00 50.00 51.00 52.00

+/'1' == 'b' text 73 # Pop count!
	3

1e10001
	1e+10001

'%d' text 1e10001 # Force integer output.
	100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
